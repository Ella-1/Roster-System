"use client";

import {
    Box,
    Flex,
    VStack,
    Text,
    IconButton,
} from "@chakra-ui/react";
import { useState } from "react";
import { navigation } from "../navigation";
import { ArrowDown2 } from "iconsax-reactjs";
import SidebarItem from "./SidebarItem";
import Image from "next/image";
import { HamburgerMenu } from "iconsax-reactjs";

export default function Sidebar() {
    const [openGroup, setOpenGroup] = useState<string | null>("Rooster");

    return (
        <Box
            w="280px"
            h="100vh"
            bg="#FFFFFF"
            px="6"
            py="8"
            borderRight="1px solid"
            borderColor="#D9E5F2"
        >
            <Flex align="center" justify="space-between" mb="12">
                {/* Logo + Text */}
                <Flex align="center" gap="3">
                    <Image
                        src="logo/logo.svg"
                        alt="Excellent Care Clinics"
                        width={48}
                        height={48}
                        priority
                    />

                    <Box>
                        <Text
                            fontSize="xl"
                            fontWeight="600"
                            color="#577AEE"
                            lineHeight="1"
                        >
                            <svg width="110" height="30" viewBox="0 0 110 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M38.9052 0.00195312H38.4877C38.337 0.00195312 38.2148 0.120649 38.2148 0.267067V13.0459C38.2148 13.1923 38.337 13.311 38.4877 13.311H38.9052C39.0559 13.311 39.178 13.1923 39.178 13.0459V0.267067C39.178 0.120649 39.0559 0.00195312 38.9052 0.00195312Z" fill="#577AEE" />
                                <path d="M43.2388 0.000764608L42.8689 0.00142417C42.7051 0.00171631 42.5725 0.131003 42.5728 0.290196L42.5945 13.0263C42.5948 13.1855 42.7278 13.3143 42.8916 13.314L43.2615 13.3133C43.4254 13.313 43.5579 13.1838 43.5577 13.0246L43.5359 0.288478C43.5356 0.129286 43.4026 0.000472475 43.2388 0.000764608Z" fill="#577AEE" />
                                <path d="M67.5186 5.04422L67.4802 3.208C67.4747 2.92865 67.6138 2.78987 67.9013 2.78809H68.1009C68.3756 2.78809 68.5111 2.91975 68.5092 3.18665L68.4946 4.98906C68.4946 5.08514 68.5715 5.16165 68.6704 5.16343C68.6704 5.16343 68.6722 5.16343 68.674 5.16343L70.604 5.15275C70.8036 5.15275 70.9025 5.24705 70.9007 5.441V5.80397C70.897 6.00503 70.7945 6.10289 70.5875 6.09755L68.8315 6.05663C68.5715 6.05129 68.4452 6.17406 68.4507 6.42672C68.4909 8.06722 68.5184 9.71661 68.533 11.3749C68.544 12.7574 69.5951 12.6524 70.6004 12.414C70.8146 12.3642 70.9336 12.4443 70.9574 12.656L70.994 12.962C71.016 13.1435 70.8897 13.309 70.7066 13.3446C69.542 13.5634 68.1851 13.5901 67.6651 12.3873C67.5314 12.0795 67.471 11.4514 67.4802 10.5066C67.4948 9.10988 67.4912 7.71136 67.4674 6.31462C67.4655 6.1705 67.3428 6.05485 67.1945 6.05663C67.1945 6.05663 67.1927 6.05663 67.1909 6.05663L66.0977 6.0851C65.7827 6.09399 65.6271 5.94631 65.6289 5.64028V5.578C65.6308 5.28442 65.7846 5.1403 66.0867 5.14563L67.385 5.1741C67.4582 5.1741 67.5168 5.11895 67.5186 5.04778C67.5186 5.04778 67.5186 5.046 67.5186 5.04422Z" fill="#577AEE" />
                                <path d="M1.29114 10.737C2.14626 12.3757 3.52691 12.9113 5.43308 12.3473C5.92931 12.2014 6.38892 11.9025 6.81556 11.4505C7.02248 11.2317 7.23122 11.2281 7.4418 11.4434L7.50222 11.5039C7.73477 11.7405 7.73111 11.9718 7.48758 12.1978C5.3342 14.212 1.41748 13.8508 0.313328 10.9808C-0.254312 9.50754 -0.0638741 7.60193 0.99267 6.35288C2.64615 4.39923 5.75536 4.47751 7.29348 6.48632C7.88126 7.25497 8.14128 8.19621 8.07719 9.31182C8.0717 9.41324 8.01676 9.46484 7.91239 9.46662C5.70225 9.48619 3.49212 9.5627 1.28564 9.43815C1.15746 9.43104 1.0476 9.52534 1.03845 9.65167V9.65523C1.02014 10.02 1.10437 10.3812 1.29114 10.737ZM1.28198 8.50047L6.71851 8.51648C6.89979 8.51648 7.04628 8.37236 7.04445 8.19621C7.04445 8.16597 7.03895 8.13572 7.03163 8.10725C6.08861 5.04155 1.82765 5.18923 1.0769 8.24603C1.03478 8.41507 1.10253 8.50047 1.28198 8.50047Z" fill="#577AEE" />
                                <path d="M19.9157 10.2157C20.5309 12.543 23.4515 13.3863 25.2277 11.6587C25.3687 11.5199 25.5133 11.5181 25.658 11.6551L25.9583 11.9362C26.0938 12.0626 26.0974 12.1942 25.9674 12.3277C24.8669 13.4682 22.9443 13.7796 21.4538 13.1977C17.7165 11.7352 17.9014 6.24965 21.798 5.11803C23.2867 4.68566 24.6747 5.00949 25.9583 6.08951C26.1579 6.25854 26.1524 6.41868 25.94 6.5717L25.7459 6.71048C25.5719 6.83681 25.332 6.82614 25.1709 6.6838C23.4533 5.1803 20.9337 5.87244 20.0512 7.77805C19.7197 8.49154 19.6758 9.3029 19.9157 10.2157Z" fill="#577AEE" />
                                <path d="M28.6735 9.48412C28.5489 9.48412 28.4464 9.58376 28.4464 9.70653C28.4464 9.72076 28.4464 9.73677 28.4519 9.75101C28.7723 11.267 29.5835 12.1744 30.8818 12.4715C32.0921 12.7491 33.4728 12.3523 34.2894 11.4431C34.4854 11.2243 34.6923 11.2154 34.9083 11.4164L35.0255 11.525C35.2508 11.7367 35.2526 11.9502 35.031 12.1655C33.7786 13.3736 31.9017 13.8024 30.2427 13.2615C27.432 12.347 26.6794 8.75995 28.3072 6.60168C29.5652 4.93271 31.7277 4.42206 33.5918 5.46116C35.0164 6.2565 35.6609 7.54292 35.5273 9.3222C35.5218 9.40761 35.4485 9.47522 35.3588 9.47522L28.6735 9.48412ZM28.6368 8.51263L34.5073 8.53398C34.5073 8.53398 34.5147 8.53042 34.5147 8.52686C34.5202 7.07497 33.2146 5.89352 31.5996 5.88641H31.5666C29.9497 5.87929 28.635 7.05184 28.6295 8.50551C28.6295 8.50551 28.6332 8.51263 28.6368 8.51263Z" fill="#577AEE" />
                                <path d="M47.4668 9.48042C47.3313 9.54981 47.28 9.69215 47.3111 9.90744C47.6059 11.8664 49.3858 12.9304 51.3029 12.4411C52.1196 12.233 52.7257 11.8753 53.1212 11.3682C53.2512 11.201 53.3995 11.185 53.5662 11.3202L53.8408 11.5408C54.0074 11.6761 54.0294 11.8308 53.9067 12.0034C53.156 13.0639 51.6929 13.4927 50.4112 13.4749C48.2377 13.4447 46.6757 12.128 46.326 9.99463C46.011 8.07122 46.857 6.02327 48.7888 5.24573C50.0285 4.74753 51.3487 4.84361 52.4876 5.53575C53.7346 6.2955 54.359 7.51609 54.3572 9.19929C54.3572 9.33808 54.2437 9.45017 54.1008 9.45373C51.9163 9.50355 49.7355 9.50533 47.5547 9.46084C47.5254 9.46084 47.4942 9.46618 47.4668 9.48042ZM47.4283 8.51071L53.2622 8.50003C53.2622 8.50003 53.2695 8.49647 53.2695 8.49292V8.48224C53.2659 7.05347 51.9804 5.89872 50.3947 5.9005H50.2885C48.7028 5.90228 47.4192 7.06237 47.421 8.49114V8.50359C47.421 8.50359 47.4247 8.51071 47.4283 8.51071Z" fill="#577AEE" />
                                <path d="M57.8318 6.24742C57.8336 6.30969 57.8886 6.35951 57.9527 6.35773C57.9875 6.35773 58.0204 6.33994 58.0406 6.31325C58.9195 5.19408 60.0365 4.75104 61.3933 4.98235C63.175 5.2866 63.9001 6.59794 63.8964 8.26157C63.8964 9.81488 63.9056 11.4038 63.9257 13.0283C63.9294 13.2471 63.8195 13.3521 63.5943 13.3432L63.2317 13.329C62.9992 13.3201 62.8838 13.2044 62.8838 12.9802C62.882 11.3913 62.8765 9.81844 62.8673 8.26157C62.86 6.8844 62.2741 5.83463 60.6956 5.88444C59.0275 5.93604 58.0753 6.83102 57.8428 8.57294C57.7622 9.17612 57.7622 10.6369 57.8428 12.9589C57.8519 13.2169 57.7256 13.3414 57.4601 13.3343L57.2111 13.329C56.9199 13.3218 56.7734 13.1759 56.7734 12.8913L56.7826 5.52325C56.7826 5.19942 56.9456 5.07131 57.2715 5.13715L57.4107 5.16561C57.6652 5.21721 57.797 5.37023 57.8062 5.62289L57.83 6.24742H57.8318Z" fill="#577AEE" />
                                <path d="M78.3684 10.5298C78.98 12.35 81.6479 13.2877 83.2062 11.9657C83.349 11.8429 83.479 11.7362 83.5944 11.6437C83.7555 11.5138 83.9075 11.5245 84.0503 11.6739L84.303 11.939C84.4184 12.0618 84.4165 12.2486 84.2993 12.3696C83.7079 12.9728 83.0084 13.3215 82.2046 13.4123C79.0789 13.7663 76.8266 11.7006 77.1983 8.62067C77.6195 5.12794 81.6497 3.77034 84.325 6.10654C84.4458 6.21152 84.4568 6.39122 84.3488 6.50866C84.3268 6.53179 84.3012 6.55136 84.2737 6.56737L84.1693 6.62609C83.9112 6.76843 83.6621 6.7542 83.4222 6.58339C82.254 5.75246 81.0858 5.63681 79.9157 6.23287C78.2476 7.08159 77.8282 8.92314 78.3684 10.5298Z" fill="#577AEE" />
                                <path d="M91.8225 8.19741C92.1888 6.78289 91.0297 5.93595 89.7076 5.88791C88.8177 5.85588 88.0322 6.03914 87.351 6.43948C86.95 6.67435 86.7339 6.64054 86.4794 6.27045C86.4007 6.15658 86.4062 6.04626 86.494 5.94128C86.7522 5.62813 87.1111 5.49291 87.5671 5.3043C89.5575 4.48939 92.674 4.98403 92.7564 7.59424C92.8077 9.20627 92.707 11.1599 92.8773 13.0228C92.8974 13.2292 92.8003 13.3324 92.5861 13.3306H92.3133C92.0972 13.3289 91.9745 13.2239 91.9452 13.0157L91.8702 12.4855C91.8555 12.3663 91.742 12.2826 91.6193 12.2987C91.5607 12.3058 91.5058 12.336 91.4691 12.3823C90.0537 14.1829 85.8092 13.7915 85.9282 11.0016C86.0399 8.37534 89.6673 8.21876 91.6028 8.35221C91.7218 8.36111 91.7951 8.30951 91.8225 8.19741ZM91.623 9.14933C90.3064 9.11018 86.3109 9.13332 87.0086 11.4766C87.4554 12.9801 89.8523 12.6937 90.9161 12.0158C91.7346 11.4944 91.9288 10.176 91.7951 9.29879C91.7823 9.21516 91.7109 9.15289 91.623 9.14933Z" fill="#577AEE" />
                                <path d="M96.7009 6.30466C96.7083 6.3705 96.7705 6.41854 96.8383 6.41142C96.8767 6.40786 96.9097 6.38651 96.9298 6.35626C97.4627 5.55025 98.7005 4.66061 99.7534 4.98266C99.8157 5.00223 99.8669 5.04671 99.8925 5.10543C99.9933 5.33495 100.004 5.5716 99.9237 5.81892C99.8907 5.92212 99.7882 5.98795 99.6783 5.98083C98.4405 5.89899 96.95 6.54131 96.8383 7.9078C96.7028 9.55007 96.679 11.2351 96.7687 12.961C96.7815 13.2118 96.6588 13.3364 96.3988 13.3328H96.1242C95.855 13.3275 95.7213 13.1958 95.7213 12.9343L95.7012 5.4079C95.7012 5.24955 95.7836 5.16948 95.9465 5.16948H96.3109C96.4812 5.16948 96.5764 5.25311 96.5966 5.41858L96.7009 6.30466Z" fill="#577AEE" />
                                <path d="M101.969 9.6176C101.956 9.66564 101.954 9.71724 101.963 9.77417C102.368 12.5321 105.439 13.4413 107.49 11.6495C107.667 11.493 107.812 11.3631 107.922 11.2599C108.011 11.1762 108.151 11.1762 108.238 11.2599L108.625 11.6317C108.72 11.7225 108.733 11.8684 108.652 11.9734C107.521 13.4342 105.164 13.8096 103.49 13.1815C100.141 11.9253 100.105 6.80455 103.353 5.32775C106.351 3.96304 109.299 6.23518 109.004 9.34715C108.995 9.43789 108.943 9.48415 108.85 9.48415H102.145C102.06 9.48415 101.989 9.53931 101.969 9.6176ZM102.121 8.5269L107.933 8.49843C107.945 8.49843 107.956 8.48775 107.956 8.4753V8.46818C107.949 7.03408 106.642 5.87933 105.036 5.88644H104.992C103.386 5.89534 102.091 7.06255 102.099 8.49665V8.50377C102.099 8.51622 102.11 8.5269 102.123 8.5269H102.121Z" fill="#577AEE" />
                                <path d="M12.6237 8.95358C12.6805 8.88241 12.6805 8.81124 12.6219 8.74006L9.89536 5.40213C9.76169 5.24021 9.80197 5.15837 10.0162 5.15659L10.6388 5.15125C10.853 5.14947 11.0251 5.23132 11.1533 5.40035L13.1327 8.02301C13.2096 8.12443 13.3525 8.14934 13.4605 8.08173C13.5264 8.0408 13.5997 7.96963 13.6821 7.86644C14.3394 7.04263 14.9437 6.21704 15.4949 5.38967C15.6011 5.22954 15.7878 5.13524 15.9856 5.14413L16.6228 5.1726C16.8444 5.1815 16.8865 5.27224 16.7528 5.44127L14.16 8.71515C14.0666 8.83259 14.0684 8.94824 14.16 9.06389L17.3699 13.0228C17.5475 13.2399 17.4926 13.3448 17.2088 13.336L16.7748 13.3235C16.4928 13.3164 16.2291 13.1847 16.057 12.9676L13.5795 9.85389C13.4788 9.72579 13.2902 9.70266 13.1584 9.8023C13.1364 9.81831 13.1181 9.83788 13.1016 9.85745L10.6699 12.9854C10.4813 13.2292 10.2286 13.3466 9.91184 13.3377L9.68478 13.3288C9.3387 13.3182 9.27278 13.1794 9.48336 12.9125L12.6219 8.95358H12.6237Z" fill="#577AEE" />
                                <path d="M10.3512 15.6992H9.93372C9.78911 15.6992 9.67188 15.8131 9.67188 15.9537V28.7325C9.67188 28.873 9.78911 28.9869 9.93372 28.9869H10.3512C10.4958 28.9869 10.6131 28.873 10.6131 28.7325V15.9537C10.6131 15.8131 10.4958 15.6992 10.3512 15.6992Z" fill="#577AEE" />
                                <path d="M14.7909 18.3749C15.1858 18.2428 15.3879 17.8027 15.2424 17.3921C15.0969 16.9814 14.6588 16.7556 14.2639 16.8877C13.869 17.0198 13.6668 17.4599 13.8123 17.8706C13.9579 18.2812 14.396 18.507 14.7909 18.3749Z" fill="#577AEE" />
                                <path d="M28.9412 18.3999C29.3801 18.3999 29.7359 18.0542 29.7359 17.6277C29.7359 17.2012 29.3801 16.8555 28.9412 16.8555C28.5023 16.8555 28.1465 17.2012 28.1465 17.6277C28.1465 18.0542 28.5023 18.3999 28.9412 18.3999Z" fill="#577AEE" />
                                <path d="M1.57711 26.3656C2.42124 28.3033 5.08732 28.9349 6.62544 27.4278C6.82137 27.2357 7.02462 27.2268 7.23703 27.3994L7.42014 27.5488C7.63621 27.725 7.64171 27.9065 7.43662 28.0969C6.56502 28.8993 5.75018 29.1306 4.60757 29.1431C2.42124 29.1662 0.846495 27.9207 0.35393 25.8354C0.298997 25.6059 0.299 25.0543 0.352102 24.1824C0.396049 23.4494 0.73846 22.7145 1.37751 21.9779C2.07882 21.1683 3.05114 20.736 4.29262 20.6808C5.48833 20.6274 6.55586 20.9993 7.49339 21.7964C7.7003 21.9726 7.69114 22.1363 7.46226 22.2857L7.33225 22.3711C7.10336 22.5206 6.80123 22.5028 6.59065 22.3302C4.70645 20.7804 2.06784 21.7448 1.41597 23.9191C1.16877 24.7393 1.22371 25.5543 1.57711 26.3656Z" fill="#577AEE" />
                                <path d="M19.4085 22.0115C19.4305 21.9991 19.4488 21.9831 19.4634 21.9635C20.7965 20.1415 24.1181 20.154 24.9915 22.3887C25.1618 22.8247 25.2497 23.62 25.2552 24.7748C25.2607 26.1181 25.2607 27.4419 25.2552 28.7443C25.2552 28.9134 25.1655 28.997 24.9915 28.9952L24.6106 28.9917C24.4568 28.9917 24.3286 28.8796 24.3085 28.7319C24.2865 28.5664 24.2755 28.4009 24.2755 28.2337C24.2829 25.958 24.2774 24.5346 24.2609 23.9634C24.2353 23.0453 23.9258 21.9226 22.9114 21.6788C21.0949 21.2411 19.3426 22.2962 19.2272 24.1876C19.1851 24.9046 19.1887 26.4099 19.2418 28.7034C19.2473 28.9329 19.132 29.0415 18.8958 29.0272L18.5167 29.0023C18.275 28.9881 18.1542 28.8635 18.1523 28.6269L18.123 21.081C18.123 20.9511 18.2293 20.8443 18.3629 20.8443C18.3684 20.8443 18.3757 20.8443 18.3812 20.8443L18.8042 20.8746C18.9745 20.887 19.0716 20.9742 19.0954 21.1397C19.121 21.3212 19.1375 21.5649 19.1448 21.8727C19.1503 22.0596 19.2382 22.1058 19.4085 22.0115Z" fill="#577AEE" />
                                <path d="M34.8343 28.9085C32.9501 28.2395 31.8551 26.2751 32.1298 24.366C32.3587 22.7788 33.4299 21.2291 35.1053 20.8252C36.6911 20.4426 37.9619 20.722 39.2546 21.738C39.5201 21.9461 39.5128 22.149 39.2363 22.3429L39.1704 22.3874C38.9268 22.5582 38.6925 22.5493 38.4654 22.3607C37.158 21.2789 35.3306 21.3608 34.1294 22.4408C32.9685 23.4852 32.8989 25.6559 33.7119 26.9032C34.7245 28.4512 37.1232 28.7145 38.4526 27.4352C38.6412 27.2555 38.8408 27.2413 39.0532 27.3925L39.2656 27.5455C39.4908 27.7075 39.5036 27.8854 39.304 28.0758C38.1614 29.1682 36.3029 29.428 34.8343 28.9085Z" fill="#577AEE" />
                                <path d="M42.6148 23.9941C43.5725 24.3784 46.3173 24.3677 46.6579 26.1328C47.35 29.7127 41.7158 29.9636 40.4779 27.7199C40.4468 27.6647 40.445 27.5971 40.4724 27.5384C40.542 27.3978 40.6702 27.2733 40.8588 27.1612C41.0767 27.0331 41.2488 27.042 41.3788 27.1897C42.1644 28.0775 43.1092 28.4067 44.2134 28.1754C44.6876 28.0758 45.0447 27.9014 45.2846 27.6523C45.7405 27.1772 45.8339 26.2075 45.1436 25.8125C44.3086 25.3339 43.4297 25.2645 42.5214 25.0207C40.0421 24.3553 40.1483 21.6472 42.4207 20.8109C42.7503 20.6882 43.2997 20.6455 44.0705 20.6811C44.8836 20.7184 45.5959 21.0814 46.2093 21.77C46.4565 22.0458 46.4107 22.2664 46.0738 22.4283L45.9895 22.4675C45.6691 22.6223 45.3999 22.56 45.1838 22.2842C44.4844 21.3928 42.8492 21.3839 42.06 22.1365C41.3257 22.8358 41.7963 23.6649 42.6148 23.9941Z" fill="#577AEE" />
                                <path d="M14.7055 20.8379H14.2843C14.1154 20.8379 13.9785 20.9709 13.9785 21.135V28.7183C13.9785 28.8824 14.1154 29.0155 14.2843 29.0155H14.7055C14.8744 29.0155 15.0113 28.8824 15.0113 28.7183V21.135C15.0113 20.9709 14.8744 20.8379 14.7055 20.8379Z" fill="#577AEE" />
                                <path d="M29.1047 20.8152L28.7642 20.8158C28.574 20.8161 28.4202 20.9662 28.4205 21.1509L28.4341 28.6915C28.4344 28.8762 28.5888 29.0257 28.7789 29.0254L29.1195 29.0248C29.3096 29.0245 29.4635 28.8745 29.4631 28.6898L29.4496 21.1492C29.4493 20.9644 29.2949 20.8149 29.1047 20.8152Z" fill="#577AEE" />
                            </svg>

                        </Text>

                    </Box>
                </Flex>

                {/* Menu Button */}
                <IconButton
                    aria-label="menu"
                    variant="outline"
                    size="md"
                    border="1px solid"
                    borderRadius="xl"
                    borderColor="#F0F5FA"
                    bg="#FFFFFF"
                    _hover={{ bg: "gray.200" }}

                >
                    <HamburgerMenu size="20" color="#000000" />
                </IconButton>
            </Flex>
       
            <VStack align="stretch" gap="2">
                {navigation.map((item) => {
                    const hasChildren = !!item.children;
                    const isOpen = openGroup === item.label;

                    if (!hasChildren) {
                        return <SidebarItem key={item.label} item={item} />;
                    }

                    return (
                        <Box key={item.label}>
                        
                            <Flex
                                align="center"
                                justify="space-between"
                                cursor="pointer"
                                onClick={() =>
                                    setOpenGroup(isOpen ? null : item.label)
                                }
                                px="3"
                                py="2"
                                borderRadius="md"
                                _hover={{ bg: "gray.100" }}
                            >
                                <Flex align="center" gap="3">
                                    <item.icon size="20" />
                                    <Text fontWeight="medium">
                                        {item.label}
                                    </Text>
                                </Flex>

                                <ArrowDown2
                                    size="16"
                                    style={{
                                        transform: isOpen
                                            ? "rotate(180deg)"
                                            : "rotate(0deg)",
                                        transition: "transform 0.2s ease",
                                    }}
                                />
                            </Flex>

                            {/* Animated Children */}
                            <Box
                                overflow="hidden"
                                transition="all 0.25s ease"
                                maxH={isOpen ? "500px" : "0px"}
                            >
                                <VStack
                                    align="stretch"
                                    mt="2"
                                    gap="1"
                                    pl="6"
                                >
                                    {item.children?.map((child) => (
                                        <SidebarItem
                                            key={child.label}
                                            item={child}
                                            isSubItem
                                        />
                                    ))}
                                </VStack>
                            </Box>
                        </Box>
                    );
                })}
            </VStack>
        </Box>
    );
}
